nba <- read.csv("nba.csv")
View(nba)
reg.ows <- lm(formula = ows ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
summary.ows <- my.summary.lm(summary(reg.ows),
my.rows=grep("contract_year|min|season|salary_current",
names(coef(reg.ows))))
library(dplyr)
library(tidyverse)
library(janitor)
library(stringr)
library(hdm) ## for double lasso
library(ggplot2)
library(stargazer)
library(fastDummies)
library(lmtest)
library(geepack)
library(broom)
install.packages('dplyr')
install.packages('tidyverse')
install.packages('janitor')
install.packages('janitor')
install.packages('stringr')
install.packages("stringr")
install.packages('hdm')
install.packages('ggplot2')
install.packages('stargazer')
install.packages('fastDummies')
install.packages('lmtest')
install.packages('geepack')
install.packages('broom')
reg.dws <- lm(formula = dws ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
summary.dws <- my.summary.lm(summary(reg.dws),
my.rows=grep("contract_year|min|season|salary_current",
names(coef(reg.dws))))
reg.dws <- lm(formula = dws ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
summary.dws <- my.summary.lm(summary(reg.dws),
my.rows=grep("contract_year|min|season|salary_current",
names(coef(reg.dws))))
library(dplyr)
library(tidyverse)
library(janitor)
library(stringr)
library(hdm) ## for double lasso
library(ggplot2)
library(stargazer)
library(fastDummies)
library(lmtest)
library(geepack)
library(broom)
reg.dws <- lm(formula = dws ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
summary.dws <- my.summary.lm(summary(reg.dws),
my.rows=grep("contract_year|min|season|salary_current",
names(coef(reg.dws))))
reg.dws <- lm(formula = dws ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
nba$predicted_regdws <- predict(reg.dws, nba)
reg.dws <- lm(formula = dws ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
nba$predicted_regdws <- predict(reg.dws, nba)
reg.ows <- lm(formula = ows ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
nba$predicted_regows <- predict(reg.ows, nba)
reg.ws <- lm(formula = ws ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
nba$predicted_regws <- predict(reg.ws, nba)
plot(nba$predicted_regdws, nba$dws)
plot(nba$predicted_regdws, nba$dws, col='blue', pch = 16,
main = "Actual Defensive Win Shares Against Predicted Defensive Win Shares Using WLS")
reg.dws <- lm(formula = dws ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
nba$predicted_regdws <- predict(reg.dws, nba)
reg.ows <- lm(formula = ows ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
nba$predicted_regows <- predict(reg.ows, nba)
reg.ws <- lm(formula = ws ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
nba$predicted_regws <- predict(reg.ws, nba)
plot(nba$predicted_regdws, nba$dws, col='blue', pch = 16,
main = "Actual Defensive Win Shares Against Predicted Defensive Win Shares Using WLS",
ylab = "Defensive Win Shares",
xlab = "Predicted Defensive Win Shares")
plot(nba$predicted_regows, nba$ows, col='green', pch = 16,
main = "Actual OFfensive Win Shares Against Predicted Offensive Win Shares Using WLS",
ylab = "Offensive Win Shares",
xlab = "Predicted Offensive Win Shares")
plot(nba$predicted_regws, nba$ws, col='red', pch = 16,
main = "Actual Win Shares Against Predicted Win Shares Using WLS",
ylab = "Win Shares",
xlab = "Predicted Win Shares")
reg.dws <- lm(formula = dws ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
nba$predicted_regdws <- predict(reg.dws, nba)
reg.ows <- lm(formula = ows ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
nba$predicted_regows <- predict(reg.ows, nba)
reg.ws <- lm(formula = ws ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
nba$predicted_regws <- predict(reg.ws, nba)
plot(nba$predicted_regdws, nba$dws, col='blue', pch = 16,
main = "Actual Defensive Win Shares Against Predicted Defensive Win Shares Using WLS",
ylab = "Defensive Win Shares",
xlab = "Predicted Defensive Win Shares")
plot(nba$predicted_regows, nba$ows, col='green', pch = 16,
main = "Actual OFfensive Win Shares Against Predicted Offensive Win Shares Using WLS",
ylab = "Offensive Win Shares",
xlab = "Predicted Offensive Win Shares")
plot(nba$predicted_regws, nba$ws, col='red', pch = 16,
main = "Actual Win Shares Against Predicted Win Shares Using WLS",
ylab = "Win Shares",
xlab = "Predicted Win Shares")
plot(nba$predicted_regdws, nba$contract_year, col='blue', pch = 16,
main = "Actual Defensive Win Shares Against Contract Year Using WLS",
ylab = "Defensive Win Shares",
xlab = "Contract Year")
plot(nba$predicted_regows, nba$contract_year, col='green', pch = 16,
main = "Actual OFfensive Win Shares Against Contract Year Using WLS",
ylab = "Offensive Win Shares",
xlab = "Contract Year")
plot(nba$predicted_regws, nba$contract_year, col='red', pch = 16,
main = "Actual Win Shares Against Contract Year Using WLS",
ylab = "Win Shares",
xlab = "Contract Year")
plot(nba$contract_year, nba$predicted_regdws, col='blue', pch = 16,
main = "Actual Defensive Win Shares Against Contract Year Using WLS",
ylab = "Defensive Win Shares",
xlab = "Contract Year")
plot(nba$contract_year, nba$predicted_regows, col='green', pch = 16,
main = "Actual OFfensive Win Shares Against Contract Year Using WLS",
ylab = "Offensive Win Shares",
xlab = "Contract Year")
plot(nba$contract_year, nba$predicted_regws,  col='red', pch = 16,
main = "Actual Win Shares Against Contract Year Using WLS",
ylab = "Win Shares",
xlab = "Contract Year")
reg.dws <- lm(formula = dws ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
nba$predicted_regdws <- predict(reg.dws, nba)
reg.ows <- lm(formula = ows ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
nba$predicted_regows <- predict(reg.ows, nba)
reg.ws <- lm(formula = ws ~ contract_year + min + as.factor(name) + pos + as.factor(season)
+ salary_current, data = nba, weights = nba$min)
nba$predicted_regws <- predict(reg.ws, nba)
plot(nba$predicted_regdws, nba$dws, col='blue', pch = 16,
main = "Actual Defensive Win Shares Against Predicted Defensive Win Shares Using WLS",
ylab = "Defensive Win Shares",
xlab = "Predicted Defensive Win Shares")
plot(nba$predicted_regows, nba$ows, col='green', pch = 16,
main = "Actual Offensive Win Shares Against Predicted Offensive Win Shares Using WLS",
ylab = "Offensive Win Shares",
xlab = "Predicted Offensive Win Shares")
plot(nba$predicted_regws, nba$ws, col='red', pch = 16,
main = "Actual Win Shares Against Predicted Win Shares Using WLS",
ylab = "Win Shares",
xlab = "Predicted Win Shares")
plot(nba$contract_year, nba$predicted_regdws, col='blue', pch = 16,
main = "Actual Defensive Win Shares Against Contract Year Using WLS",
ylab = "Defensive Win Shares",
xlab = "Contract Year")
plot(nba$contract_year, nba$predicted_regows, col='green', pch = 16,
main = "Actual Offensive Win Shares Against Contract Year Using WLS",
ylab = "Offensive Win Shares",
xlab = "Contract Year")
plot(nba$contract_year, nba$predicted_regws,  col='red', pch = 16,
main = "Actual Win Shares Against Contract Year Using WLS",
ylab = "Win Shares",
xlab = "Contract Year")
